import telegram
from telegram.ext import Updater, MessageHandler, Filters

# token del bot
TOKEN = 'TELEGRAM_BOT_TOKEN'

#id del chat @cveNotify 
CHAT_ID = '@cveNotify'

# palabras clave
WORDS = ['poc', 'proof of exploit', 'cisco', 'meraki', 'apache', 'jira', 'atlassian', 'drupal', 'windows', 'linux']

def check_message(bot, update):
    message = update.message.text.lower()
    for word in WORDS:
        if word in message:
            bot.send_message(chat_id=CHAT_ID, text=f'Alert: "{word}" found in message "{message}"')

def main():
    updater = Updater(TOKEN)
    dispatcher = updater.dispatcher

    # message handler for notifications
    message_handler = MessageHandler(Filters.text, check_message)

    # message handler for dispatcher
    dispatcher.add_handler(message_handler)

    # lanzar el bot
    updater.start_polling()

if __name__ == '__main__':
    main()
